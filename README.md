# UESTC_Login: A simple python package to get services certification from new CAS system

**[中文文档](README_zh_cn.md)**

## Prerequisites

### 0. Clone this repo
```Bash
git clone https://github.com/xyangzhou/UESTC_login
cd UESTC_login
```

### 1. Install dependencies
This code was tested in Python 3.9 with [Requests](https://github.com/psf/requests), [BeautifulSoup4](https://www.crummy.com/software/BeautifulSoup/) and [Js2Py](https://github.com/PiotrDabkowski/Js2Py).
```Bash
######## Optional #######
conda create --name UESTC_login python=3.9
conda actiavte UESTC_login
######## Optional #######
pip install -r requirements.txt
```

## Usage
[UESTC_login](src/login.py) provides a simple interface to log to [https://idas.uestc.edu.cn/](https://idas.uestc.edu.cn/). The detailed configuration was listed in [config.json](configs/config.json). The [demo](demo.py) is avaliable.

```python
login = UESTC_login(cfg['baseurl'], cfg['login_url'], cfg['headers'])
status_code, headers = login.login(<STUDENT_ID>, <PASSWORD>)
```

Paramaters:
- `cfg['headers']` is a fixed request header in [config.json](configs/config.json).
- `cfg['baseurl']` is a fixed baseurl `https://idas.uestc.edu.cn`.
- `cfg['login_url']` is the required service url of the form `https://idas.uestc.edu.cn/authserver/login?service=<SERVICE_URL>` which was generated by the service website. Our project [UESTC_schedule](https://github.com/xyangzhou/UESTC_schedule) provided an instance.

Return:
- `status_code` is a HTTP status code which should be 302 Redirect.
- `headers` is the headers of respond. If login is successful, the sevice url should locate in `headers['Location']` of the form `https://<SERVICE_URL>&ticket=<ST_TOKEN>`.

## TODO
- [ ] Build this package as a wheel.
- [ ] Add comments on source code.
- [ ] Since the captcha has never triggered, the captcha was not support yet.